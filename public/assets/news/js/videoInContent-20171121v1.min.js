var videoInContent = { isFullscreen: !1, scrolling: !1, admPlayProgressing: null, currentPlayingVideo: null, playedVideoIds: [], players: [], init: function (e) { function n(e) { const n = {}; return n.iframe = $(e), n.wrap = $(e).parents(".VCSortableInPreviewMode"), n.timer = !1, n.loaded = !1, n.progressing = !1, n } if (!detectmob()) { !function () { var e = jQuery.event.special, n = "D" + +new Date, i = "D" + (+new Date + 1); e.scrollstart = { setup: function () { var i, r = function (n) { var r = this, t = arguments; i ? clearTimeout(i) : (n.type = "scrollstart", jQuery.event.handle.apply(r, t)), i = setTimeout(function () { i = null }, e.scrollstop.latency) }; jQuery(this).bind("scroll", r).data(n, r) }, teardown: function () { jQuery(this).unbind("scroll", jQuery(this).data(n)) } }, e.scrollstop = { latency: 500, setup: function () { var n, r = function (i) { var r = this, t = arguments; n && clearTimeout(n), n = setTimeout(function () { n = null, i.type = "scrollstop", jQuery.event.handle.apply(r, t) }, e.scrollstop.latency) }; jQuery(this).bind("scroll", r).data(i, r) }, teardown: function () { jQuery(this).unbind("scroll", jQuery(this).data(i)) } } }(); var i = this, r = "webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange"; $(document).on(r, function () { i.changeIsFullscreen() }); for (var t = [], a = $(window), o = a.height(), d = $(e).find('iframe[src*="vcplayer.vcmedia.vn"][playType=0], iframe[src*="123.31.11.105"][playType=0], iframe[src*="vcplayer.mediacdn.vn"][playType=0]'), s = d.length - 1; s >= 0; s--) { var l = d[s], c = $(l).attr("id"); i.players[c] = n(l) } a.on("scroll", function () { i.scrolling = !0, d.each(function (e, n) { var r = $(this), t = a.scrollTop(), d = t + o, s = r.outerHeight(), l = r.offset().top, c = l + s; (t > l || c > d) && i.stopVideo(r) }) }), a.on("scrollstop", function () { if (i.scrolling = !1, null != i.admPlayProgressing) { var e = i.admPlayProgressing.find('iframe[src*="vcplayer.vcmedia.vn"][playType=0], iframe[src*="123.31.11.105"][playType=0], iframe[src*="vcplayer.mediacdn.vn"][playType=0]'); e.attr("id") } if (d.each(function (e, n) { var r = $(this), d = a.scrollTop(), s = d + o, l = r.outerHeight(), c = r.offset().top, u = c + l; c > d && s > u ? t.push(r) : i.stopVideo(r) }), t.length > 0) { var n = void 0; if (t.length >= 2) if (null != i.admPlayProgressing) { var r = i.admPlayProgressing.find('iframe[src*="vcplayer.vcmedia.vn"][playType=0], iframe[src*="123.31.11.105"][playType=0], iframe[src*="vcplayer.mediacdn.vn"][playType=0]'); t[0].is(i.currentPlayingVideo) || t[1].is(i.currentPlayingVideo) || t[0].is(r) || t[1].is(r) ? n = void 0 == i.currentPlayingVideo || null == i.currentPlayingVideo ? r : i.currentPlayingVideo : (n = t[0], i.stopVideo(t[1])) } else t[0].is(i.currentPlayingVideo) || t[1].is(i.currentPlayingVideo) ? n = i.currentPlayingVideo : (n = t[0], i.stopVideo(t[1])); else n = t[0]; var s = n.parents(".VCSortableInPreviewMode"), l = n.attr("id"); i.playedVideoIds.indexOf(l) < 0 ? i.admPlayProgress(s) : $.inArray("#" + l, readyVideoIds) >= 0 && i.playVideo(n) } t.length = 0 }) } }, playVideo: function (e) { var n = this; if (null == n.currentPlayingVideo || !n.currentPlayingVideo.is(e)) { var i = $(e), r = i.attr("id"); i.parents(".VCSortableInPreviewMode").find(".pause-vd-notify").hide(); var t = document.getElementById(r); if (t) { var a = i.parents(".VCSortableInPreviewMode"); n.hideWrapLoading(a); var o = { action: "request", method: "play" }; t.contentWindow && t.contentWindow.postMessage(o, "*"), n.players[r].progressing = !1, n.currentPlayingVideo = e, n.playedVideoIds.indexOf(r) < 0 && n.playedVideoIds.push(r) } } }, stopVideo: function (e) { var n = this, i = $(e), r = i.attr("id"), t = i.parents(".VCSortableInPreviewMode"); if (n.players[r].progressing = !1, n.playedVideoIds.indexOf(r) < 0) return clearInterval(n.players[r].timer), void n.resetWrapLoading(t); var a = document.getElementById(r); if (a) { var o = { action: "request", method: "pause" }; a.contentWindow && a.contentWindow.postMessage(o, "*"), e.is(n.currentPlayingVideo) && (n.currentPlayingVideo = null), i.parents(".VCSortableInPreviewMode").find(".pause-vd-notify").show() } }, admPlayProgress: function (e) { var n = this; n.admPlayProgressing = e; var i = 3, r = $(e), t = r.find('iframe[src*="vcplayer.vcmedia.vn"], iframe[src*="123.31.11.105"], iframe[src*="vcplayer.mediacdn.vn"]'), a = t.attr("id"); n.scrolling || n.playedVideoIds.indexOf(a) >= 0 || n.players[a].progressing || (r.find(".bg-wraper").length > 0 ? (r.find(".loading-vid-icon").hide(), r.find(".loading-vid-countdown").fadeIn(1500), r.find(".loading-vid-countdown").addClass("quickspin"), r.find(".bg-wraper").addClass("bgPoster"), detectmob() ? ($.inArray("#" + a, readyVideoIds) >= 0 && videoInContent.playVideo(a), r.find(".bg-wraper").hide()) : (n.players[a].progressing = !0, r.find(".lvc-label").show(), r.find(".lvc-number").show(), n.players[a].timer = setInterval(function () { i >= 0 ? (0 == i && videoInContent.playVideo(t), r.find(".lvc-number").html(i)) : (clearInterval(n.players[a].timer), r.find(".bg-wraper").hide()), i -= 1 }, 500))) : $.inArray("#" + a, readyVideoIds) >= 0 && videoInContent.playVideo(t)) }, hideWrapLoading: function (e) { e.find(".loading-vid-countdown").hide(), e.find(".loading-vid-icon").hide(), e.find(".bg-wraper").removeClass("bgPoster"), e.find(".bg-wraper").css("display", "none"), e.find(".lvc-label").hide(), e.find(".lvc-number").hide() }, resetWrapLoading: function (e) { e.find(".loading-vid-countdown").hide(), e.find(".loading-vid-icon").show(), e.find(".bg-wraper").removeClass("bgPoster"), e.find(".bg-wraper").css("display", "block"), e.find(".lvc-label").hide(), e.find(".lvc-number").html("3"), e.find(".lvc-number").hide() }, hideControlBar: function (e) { var n = $(e), i = n.attr("id"), r = document.getElementById(i); if (r) { var t = 'admReviceMessageToPlayer("hidecontrolbar")'; r.contentWindow && r.contentWindow.postMessage(t, "*") } }, getCurrentTime: function (e, n) { var i = $(e), r = i.attr("id"), t = document.getElementById(r); if (t) { var a = { action: "request", method: "currentTime", cid: n }; t.contentWindow && t.contentWindow.postMessage(a, "*") } }, setCurrentTime: function (e, n) { var i = $(e); i.attr("src", i.attr("src") + "&currentTime=" + n), waitingVideoIdForReady.push("#" + i.attr("id")) }, seekCurrentTime: function (e, n) { var i = this, r = $(e), t = r.attr("id"), a = document.getElementById(t); if (a) { var o = { action: "request", method: "currentTime", args: [n] }; a.contentWindow && a.contentWindow.postMessage(o, "*") } setTimeout(function () { i.playVideo(e) }, 100) }, stopAllVideo: function () { var e = this; $('iframe[src*="vcplayer.vcmedia.vn"], iframe[src*="123.31.11.105"], iframe[src*="vcplayer.mediacdn.vn"]').each(function () { var n = $(this); e.stopVideo("#" + n.attr("id")), n.attr("data-playstatus", "stopping") }) }, changeIsFullscreen: function () { var e = this; e.isFullscreen = !e.isFullscreen } };